<!doctype html>
<html lang="en">

<!--
    @file:      index.html
    @brief:     L-System Frontend
    @author:    Raphael Pour <turtle@raphaelpour.de>
    @license:   (C) 2018 Raphael Pour LGPL
-->

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="shortcut icon" type="image/png" href="logo.png">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css" integrity="sha384-9gVQ4dYFwwWSjIDZnLEWnxCjeSWFphJiwGPXr1jddIhOegiu1FwO5qRGvFXOdJZ4"
        crossorigin="anonymous">

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js" integrity="sha384-cs/chFZiN24E4KMATLdqdvsezGxaGsi4hLGOzlXwp5UZB1LY//20VyM2taTB4QvJ"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js" integrity="sha384-uefMccjFJAIv6A+rW+L4AHf99KvxDjWSu1z9VI8SKNVmz4sk7buKt/6v9KI65qnm"
        crossorigin="anonymous"></script>
    <!-- development version, includes helpful console warnings -->
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>

    <!-- production version, optimized for size and speed -->
    <!-- <script src="https://cdn.jsdelivr.net/npm/vue"></script>-->

    <!-- Include our Turtle Class-->
    <script src="turtle.js"></script>

    <!-- Include our LSystem Class-->
    <script src="lsystem.js"></script>

    <title>L-Systems</title>
</head>

<body class="text-center">

    <div class='jumbotron' style='padding:10px'>
        <h1>
            <img src='logo.png' style='vertical-align:center;margin-right:40px'>L-Systems</h1>
        <p><em>~Fractals powered by formal languages~</em></p>
    </div>

    <div class='container' id='lSystemsApp'>

        <div class='row'>
            <div class='col-*-*'>
                <div class="form-group">
                    <button type="button" class="btn btn-primary" id="kochTemplateButton" v-on:click="setKochTemplate">Koch Curve</button>
                    <button type="button" class="btn btn-primary" id="kochSnowflakeTemplateButton" v-on:click="setKochSnowflakeTemplate">Koch Snowflake</button>
                    <button type="button" class="btn btn-primary" id="hilbertTemplateButton" v-on:click="setHilbertTemplate">Hilbert Curve</button>
                    <button type="button" class="btn btn-primary" id="sierpinskiTriangleTemplateButton" v-on:click="setSierpinskiTriangleTemplate">Sierpinski Triangle</button>
                    <button type="button" class="btn btn-primary" id="dragonCurveTemplateButton" v-on:click="setDragonCurveTemplate">Dragon Curve</button>
                    <button type="button" class="btn btn-primary" id="plantTemplateButton" v-on:click="setPlantTemplate">Plant</button>
                </div>

                <!--class='form-inline'-->
                <div id="accordion" style='padding-bottom:25px'>
                    <div class="card">
                        <div class="card-header">
                            <a class="card-link" data-toggle="collapse" href="#collapse1">L-System Language</a>
                        </div>
                        <div id="collapse1" class="collapse hidden">
                            <div class="card-body">
                                <div class="form-group">
                                    <label class="control-label" for="variables">Variables (V):</label>
                                    <input type="text" class="form-control" v-model="V" id="variables">
                                </div>

                                <div class="form-group">
                                    <label class="control-label" for="alphabet">Alphabet (&Sigma;):</label>
                                    <input type="text" class="form-control" v-model="E" id="alphabet">
                                </div>

                                <div class="form-group">
                                    <label class="control-label" for="axiom">Axiom (&omega;):</label>
                                    <input type="text" class="form-control" v-model="A" id="axiom">
                                </div>

                                <div class="form-group">
                                    <label class="control-label" for="rules">Rules (P):</label>
                                    <textarea class="form-control" rows="3" v-model="P" id="rules"></textarea>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="card">
                        <div class="card-header">
                            <a class="card-link" data-toggle="collapse" href="#collapse2">Turtle Graphic Settings</a>
                        </div>
                        <div id="collapse2" class="collapse hidden">
                            <div class="card-body">
                                <div class="form-group">
                                    <label class="control-label" for="iterations">Iterations:</label>
                                    <input type="text" class="form-control" v-model="n" id="iterations">
                                </div>

                                <div class="form-group">
                                    <label class="control-label" for="alpha">Alpha (&alpha;):</label>
                                    <input type="text" class="form-control" v-model="alpha" id="alpha">
                                </div>
                                <div class="form-group">
                                    <label class="control-label" for="length">Compression Factor:</label>
                                    <input type="text" class="form-control" v-model="length" id="length">
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="card">
                        <div class="card-header">
                            <a class="card-link" data-toggle="collapse" href="#collapse22">Turtle Command Reference</a>
                        </div>
                        <div id="collapse22" class="collapse hidden">
                            <div class="card-body">
                                <table class="table" style='text-align:left'>
                                    <thead>
                                        <tr>
                                            <th>Symbol</th>
                                            <th>Turtle Command</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td style='font-family:monospace;'>f,F,G</td>
                                            <td>Go one step forward and draw a line</td>
                                        </tr>
                                        <tr>
                                            <td style='font-family:monospace;'>+</td>
                                            <td>Turn right by &alpha;&deg;</td>
                                        </tr>
                                        <tr>
                                            <td style='font-family:monospace;'>-</td>
                                            <td>Turn left by &alpha;&deg;</td>
                                        </tr>
                                        <tr>
                                            <td style='font-family:monospace;'>[</td>
                                            <td>Push current position and orientation to the stack</td>
                                        </tr>
                                        <tr>
                                            <td style='font-family:monospace;'>]</td>
                                            <td>Pop position and orientation from the stack</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                <div v-html="log"> </div>
                <div class="form-group">
                    <button type="button" class="btn btn-primary" id="generateButton" v-on:click="generate">Generate</button>
                </div>

                <div class="form-group">
                    Output:
                    <textarea readonly  class="form-control" rows="5" id="output">{{ out }}</textarea>
                </div>
            </div>
            <div class='col-*-*' style='padding:10px;'>
                <canvas id='screen' width='400' height='400'></canvas>
            </div>
        </div>
    </div>


    <script>
        // Post Content Scripts

        var app = new Vue({
            el: '#lSystemsApp',
            data: {
                V: "FA",
                P: "A=AAffff--f--fff++ff--f--fff+AA-",
                E: "-+f",
                A: "FA",
                n: 4,
                length: 2,
                alpha: 45.0,
                out: "",
                log: "",
                ctx: null
            },
            methods: {
                setKochTemplate: function () {
                    this.V = "F";
                    this.P = "F=F-F++F-F";
                    this.E = "+-";
                    this.A = "F";
                    this.alpha = 60.0;
                    this.length = 3;
                    this.out = "";
                    this.log = "";
                },
                setKochSnowflakeTemplate: function () {
                    this.V = "F";
                    this.P = "F=F-F++F-F";
                    this.E = "+-";
                    this.A = "F++F++F";
                    this.alpha = 60.0;
                    this.length = 3;
                    this.out = "";
                    this.log = "";
                },
                setDragonCurveTemplate: function () {
                    this.V = "FG";
                    this.P = "F=F+Gf+\nG=-fF-G";
                    this.E = "+-f";
                    this.A = "fF";
                    this.alpha = 90.0;
                    this.length = 1.5;
                    this.out = "";
                    this.log = "";
                },
                setHilbertTemplate: function () {
                    this.V = "AB";
                    this.P = "A=-Bf+AfA+fB-\nB=+Af-BfB-fA+";
                    this.E = "+-f";
                    this.A = "A";
                    this.alpha = 90.0;
                    this.length = 2;
                    this.out = "";
                    this.log = "";
                },
                setSierpinskiTriangleTemplate: function () {
                    this.V = "FG";
                    this.P = "F=G-F-G\nG=F+G+F";
                    this.E = "+-";
                    this.A = "F";
                    this.alpha = 60.0;
                    this.length = 2;
                    this.out = "";
                    this.log = "";
                },
                setPlantTemplate: function () {
                    this.V = "FG";
                    this.P = "G=F+[[G]-G]-F[-FG]+F\nF=FF";
                    this.E = "+-[]";
                    this.A = "G";
                    this.alpha = 25.0;
                    this.length = 2.25;
                    this.out = "";
                    this.log = "";
                },

                generate: function () {

                    var l = new LSystem();
                    var output = "";
                    this.log = "";
                    try {
                        l.V = this.V;
                        l.E = this.E;
                        l.Axiom = this.A;
                        l.P = this.P;
                        l.n = this.n;
                        l.generate()
                        this.out = l.out;
                    } catch (error) {
                        this.log = "<div class='alert alert-danger'>[LSystem]: " + error + "</div>";
                    }

                    // Draw it.
                    try {
                        var t =  new Turtle(this.ctx, this.alpha, this.n, this.length);
                        t.clear();
                        t.computeWord(l.out);
                    } catch (error) {
                        this.log = "<div class='alert alert-danger'>[Turtle]: " + error + "</div>";
                    }
                }
            }
        });

        var canvas = document.getElementById("screen");

        if (canvas && canvas.getContext) {
            app.ctx = canvas.getContext('2d');
            app.generate();
        }
        else {
            console.log("Canvas error.");
        }



    </script>
    <div class='footer'>
        &copy; 2018 Raphael Pour | Licensed under 
        <a href='http://www.gnu.de/documents/lgpl.de.html'>LGPL</a>
    </div>
</body>

</html>